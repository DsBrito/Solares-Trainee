/*alert("Desafio Treineer em construção..");
*/

/**
 * Pegar no JS o elemento HTML correstpondente ao botão de troca de tema
 */

const lightBotton = document.getElementById("change-light");

const body = document.querySelector("body");
console.log(body);

/**
 * Identificar o clique do usuário no botão de troca de luz e trocar a imagem
 *
*/
const changeBottonImg = document.querySelector(".botton-image");

lightBotton.addEventListener("click", () => {

    const mode = body.classList.contains("black-mode");
    body.classList.toggle("black-mode"); /* alternar = toggle */
    if(mode){
        console.log("black mode off")
        console.log("click-light-button");
        changeBottonImg.setAttribute("src","./src/images/itens/sun.png");

    }
    else{
        console.log("black mode on")
        console.log("click-light-button");
        changeBottonImg.setAttribute("src","./src/images/itens/moon.png");
    }


})


//Variaveis boleanas ON/OFF
const toggleButton1 = document.getElementById('toggleButton1');
const toggleButton2 = document.getElementById('toggleButton2');
const state = {
  isOn1: false,
  isOn2: false
};

const handler = {
  set: function(target, key, value) {
    target[key] = value;
    updateButtonState(key, value);
    return true;
  }
};

const stateProxy = new Proxy(state, handler);

function updateButtonState(key, value) {
  if (key === 'isOn1') {
    toggleButton1.textContent = value ? 'ON' : 'OFF';
    toggleButton1.classList.toggle('on', value);
    toggleButton1.classList.toggle('off', !value);
  } else if (key === 'isOn2') {
    toggleButton2.textContent = value ? 'ON' : 'OFF';
    toggleButton2.classList.toggle('on', value);
    toggleButton2.classList.toggle('off', !value);
  }
}


// Exemplo de alteração nas variáveis booleanas
stateProxy.isOn1 = 1;
stateProxy.isOn2 = 1;

// connect to the websocket server
const socket = io.connect('https://telemetria-trainee-2023.onrender.com');
console.log('entrei aqui 1: ')
// this message is triggered when the websocket gets connected
socket.on('connect', () => console.log('websocket connected!'))
console.log('entrei aqui 2: ')

// this message is triggered when the websocket gets disconnected
socket.on('disconnect', () => console.log('websocket disconnect'))
console.log('entrei aqui 3: ')

// receive a message from the server on the info 'channel'
socket.on("info", data => {
  console.log('entrei aqui 4: ')

  //console.log('data: ', data.estadoStringSolar1)
  stateProxy.isOn1 =data.estadoStringSolar1;
  stateProxy.isOn2 =data.estadoStringSolar2;
});


/*

socket.on("info", data => {
  console.log('entrei aqui 4: ')

  console.log('data: ', data.estadoStringSolar1)
  console.log('data: ', data.estadoStringSolar2)
if(data.estadoStringSolar1 == 1){
  toggleButton1.textContent = 'ON'
  toggleButton1.classList.toggle('on');

}
else if(data.estadoStringSolar1==0){
  toggleButton1.textContent = 'OFF'
  toggleButton1.classList.toggle('off');
}
if(data.estadoStringSolar2 == 1){
  toggleButton2.textContent = 'ON'
  toggleButton2.classList.toggle('on', true);

}
else if(data.estadoStringSolar2==0){
  toggleButton2.textContent = 'OFF'
  toggleButton2.classList.toggle('off');
}
});

*/